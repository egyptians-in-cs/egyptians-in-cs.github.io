<div dir="rtl" class="font-arabic">

  <!-- Hero Section -->
  <section class="mb-8">
    <div class="bg-gradient-to-l from-navy-900 to-navy-800 rounded-2xl p-6 md:p-8 text-white shadow-elevated">
      <h1 class="text-2xl md:text-3xl font-bold mb-4">
        مرحبًا بكم في موقع المصريون في الذكاء الاصطناعي
      </h1>
      <p class="text-navy-200 leading-relaxed mb-6 max-w-3xl">
        موقع مخصص لعرض الباحثين المصريين البارزين في مجال الذكاء الاصطناعي وعلوم الحاسب.
        لكي يتم النظر في إضافة شخص ما، فإن المعيار الوحيد هو أن يكون لديه
        <span class="text-gold-400 font-semibold">h-index من 5 أو أعلى</span>.
        يمكنك إرسال اقتراحك عبر
        <a href="https://docs.google.com/forms/d/e/1FAIpQLSdLaYBQyOzI5gnlGzwOki3b1TJtFjLUeHUKxkGtXQDhHdSreg/viewform"
           target="_blank"
           class="text-gold-400 hover:text-gold-300 underline">هذا النموذج</a>.
      </p>

      <!-- Stats Row -->
      <div class="flex flex-wrap gap-6 mb-6">
        <div class="flex items-center gap-3">
          <div class="w-12 h-12 bg-gold-400/20 rounded-lg flex items-center justify-center">
            <i class="fa-solid fa-users text-gold-400 text-xl"></i>
          </div>
          <div>
            <div class="text-2xl font-bold text-gold-400">{{ profiles.length }}</div>
            <div class="text-sm text-navy-300">إجمالي الباحثين</div>
          </div>
        </div>
        <div class="flex items-center gap-3">
          <div class="w-12 h-12 bg-teal-400/20 rounded-lg flex items-center justify-center">
            <i class="fa-solid fa-filter text-teal-400 text-xl"></i>
          </div>
          <div>
            <div class="text-2xl font-bold text-teal-400">{{ researchers.length }}</div>
            <div class="text-sm text-navy-300">معروض حاليًا</div>
          </div>
        </div>
      </div>

      <!-- Action Links -->
      <div class="flex flex-wrap gap-4 pt-6 border-t border-navy-700">
        <a href="https://docs.google.com/forms/d/e/1FAIpQLSdLaYBQyOzI5gnlGzwOki3b1TJtFjLUeHUKxkGtXQDhHdSreg/viewform"
           target="_blank"
           class="btn-secondary">
          <i class="fa fa-pen ml-2"></i>
          رشح أحد
        </a>
        <a href="https://medium.com/@bkhmsi/egyptians-in-ai-research-1ff64c78cc5b"
           target="_blank"
           class="inline-flex items-center px-5 py-2.5 border-2 border-white/30 text-white font-medium rounded-lg hover:bg-white/10 transition-all duration-200">
          <i class="fa-brands fa-medium ml-2"></i>
          اقرأ المدونة
        </a>
      </div>
    </div>
  </section>

  <!-- Two Column Layout (RTL - sidebar on right) -->
  <div class="lg:grid lg:grid-cols-12 lg:gap-8">

    <!-- Sidebar (appears on right in RTL) -->
    <aside class="lg:col-span-3 lg:order-2 mb-8 lg:mb-0">
      <div class="lg:sticky lg:top-24 space-y-4">

        <!-- Search Box -->
        <div class="bg-white rounded-xl shadow-card p-4">
          <label class="block text-sm font-semibold text-navy-900 mb-2">
            <i class="fa fa-search text-navy-500 ml-2"></i>
            البحث عن باحث
          </label>
          <div class="relative">
            <input
              type="text"
              (keyup)="filterProfiles($event)"
              placeholder="البحث عن طريق الاسم..."
              class="input-field pl-10"
            >
            <i class="fa fa-search absolute left-4 top-1/2 -translate-y-1/2 text-navy-400"></i>
          </div>
        </div>

        <!-- Sort Buttons -->
        <div class="bg-white rounded-xl shadow-card p-4">
          <h3 class="text-sm font-semibold text-navy-900 mb-3">
            <i class="fa fa-sort text-navy-500 ml-2"></i>
            ترتيب حسب
          </h3>
          <div class="grid grid-cols-2 gap-2">
            <button
              (click)="sortAZ()"
              class="flex items-center justify-center gap-2 px-3 py-2
                     bg-navy-50 hover:bg-navy-100 text-navy-700
                     rounded-lg text-sm font-medium transition-colors">
              <i class="fas fa-sort-alpha-down"></i>
              أبجدي
            </button>
            <button
              (click)="sortHIndex()"
              class="flex items-center justify-center gap-2 px-3 py-2
                     bg-emerald-50 hover:bg-emerald-100 text-emerald-700
                     rounded-lg text-sm font-medium transition-colors">
              <i class="fa-solid fa-arrow-down-9-1"></i>
              h-Index
            </button>
            <button
              (click)="sortCitations()"
              class="flex items-center justify-center gap-2 px-3 py-2
                     bg-amber-50 hover:bg-amber-100 text-amber-700
                     rounded-lg text-sm font-medium transition-colors">
              <i class="fa-solid fa-arrow-down-9-1"></i>
              الاستشهادات
            </button>
            <button
              (click)="sortShuffle()"
              class="flex items-center justify-center gap-2 px-3 py-2
                     bg-rose-50 hover:bg-rose-100 text-rose-700
                     rounded-lg text-sm font-medium transition-colors">
              <i class="fas fa-shuffle"></i>
              عشوائي
            </button>
          </div>
        </div>

        <!-- Interest Filter -->
        <div class="bg-white rounded-xl shadow-card overflow-hidden">
          <div class="px-4 py-3 bg-navy-50 border-b border-navy-100
                      flex items-center justify-between">
            <h3 class="font-semibold text-navy-900 text-sm">
              <i class="fas fa-tags text-navy-500 ml-2"></i>
              الاهتمامات البحثية
            </h3>
            <div class="flex gap-2">
              <button
                (click)="checkAllInterests()"
                class="text-xs text-teal-600 hover:text-teal-800 transition-colors">
                تحديد الكل
              </button>
              <span class="text-navy-300">|</span>
              <button
                (click)="clearAllInterests()"
                class="text-xs text-rose-600 hover:text-rose-800 transition-colors">
                مسح
              </button>
            </div>
          </div>

          <div class="p-3 max-h-[50vh] overflow-y-auto scrollbar-academic">
            <div *ngFor="let interest of rinterests | keyvalue" class="mb-1">
              <label class="flex items-center gap-2 px-2 py-1.5 rounded-lg
                            hover:bg-navy-50 cursor-pointer transition-colors">
                <input
                  type="checkbox"
                  [id]="interest.key + 'Checkbox'"
                  [value]="interest.key"
                  (change)="filterInterests()"
                  [(ngModel)]="rinterests[interest.key]"
                  class="w-4 h-4 text-teal-600 rounded border-navy-300
                         focus:ring-teal-500 focus:ring-2"
                >
                <span class="text-sm text-navy-700 flex-1">{{ interest.key }}</span>
                <span class="text-xs text-navy-400 bg-navy-100 px-1.5 py-0.5 rounded">
                  {{ rinterestsFreq[interest.key] }}
                </span>
              </label>
            </div>
          </div>
        </div>
      </div>
    </aside>

    <!-- Main Content Area (appears on left in RTL) -->
    <div class="lg:col-span-9 lg:order-1">

      <!-- World Map Section -->
      <section class="mb-6">
        <h2 class="section-title mb-3">
          <i class="fas fa-globe-americas text-navy-500"></i>
          المصريون حول العالم
          <span class="text-sm font-normal text-navy-500 mr-2">
            ({{ locationCount }} موقع)
          </span>
        </h2>
        <div class="bg-white rounded-xl shadow-card overflow-hidden">
          <app-map
            [researchers]="researchersWithLocation"
            mapId="arabic-map">
          </app-map>
        </div>
      </section>

      <!-- Divider -->
      <div class="border-t border-navy-200 my-6"></div>

      <!-- Researcher Cards Grid -->
      <section>
        <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-6">
          <article
            *ngFor="let researcher of researchers"
            [id]="researcher.name"
            class="research-card group scroll-offset">

            <!-- Card Header with Photo -->
            <div class="relative card-header-gradient p-6 text-center">
              <!-- Edit Button -->
              <button
                (click)="editProfile(researcher)"
                class="absolute top-3 left-3 p-2 text-navy-400 hover:text-white
                       opacity-0 group-hover:opacity-100 transition-opacity"
                title="تعديل الملف">
                <i class="fa-solid fa-pencil"></i>
              </button>

              <!-- Profile Photo -->
              <img
                [src]="researcher.photo"
                [alt]="researcher.name"
                class="w-24 h-24 rounded-full mx-auto border-4 border-gold-400
                       shadow-lg object-cover"
              >

              <!-- Name -->
              <h3 class="mt-3 text-lg font-bold text-white">
                {{ researcher.name }}
              </h3>

              <!-- Position -->
              <p class="text-sm text-navy-300 mt-1">
                {{ researcher.position }}
              </p>
            </div>

            <!-- Card Body -->
            <div class="p-4">
              <!-- Affiliation -->
              <div class="flex items-start gap-2 mb-3">
                <i class="fas fa-university text-navy-400 mt-0.5 text-sm"></i>
                <span class="text-sm text-navy-600 line-clamp-2">{{ researcher.affiliation }}</span>
              </div>

              <!-- Metrics -->
              <div *ngIf="researcher.hindex > 0"
                   dir="ltr"
                   class="flex gap-4 mb-3 p-3 bg-navy-50 rounded-lg">
                <div class="text-center flex-1">
                  <div class="text-lg font-bold text-navy-900">{{ researcher.hindex }}</div>
                  <div class="text-xs text-navy-500">h-index</div>
                </div>
                <div class="w-px bg-navy-200"></div>
                <div class="text-center flex-1">
                  <div class="text-lg font-bold text-navy-900">{{ researcher.citedby | number }}</div>
                  <div class="text-xs text-navy-500">Citations</div>
                </div>
              </div>
              <div *ngIf="researcher.hindex === 0" class="mb-3 text-sm text-navy-400 italic">
                البيانات غير متوفرة
              </div>

              <!-- Research Interests -->
              <div class="mb-3">
                <h4 class="text-xs font-semibold text-navy-500 uppercase tracking-wide mb-2">
                  الاهتمامات البحثية
                </h4>
                <div class="flex flex-wrap gap-1 max-h-20 overflow-y-auto scrollbar-hide">
                  <span
                    *ngFor="let interest of researcher.interests"
                    class="inline-block px-2 py-0.5 bg-teal-500/10 text-teal-700
                           rounded text-xs">
                    {{ interest }}
                  </span>
                </div>
              </div>

              <!-- Social Links -->
              <div dir="ltr" class="flex items-center justify-center gap-2 pt-3 border-t border-navy-100">
                <a *ngIf="researcher.website"
                   [href]="researcher.website"
                   target="_blank"
                   class="social-link"
                   title="الموقع">
                  <i class="fas fa-globe"></i>
                </a>
                <a *ngIf="researcher.scholar"
                   [href]="researcher.scholar"
                   target="_blank"
                   class="social-link"
                   title="Google Scholar">
                  <i class="fas fa-graduation-cap"></i>
                </a>
                <a *ngIf="researcher.twitter"
                   [href]="researcher.twitter"
                   target="_blank"
                   class="social-link hover:bg-sky-500"
                   title="Twitter/X">
                  <i class="fab fa-twitter"></i>
                </a>
                <a *ngIf="researcher.linkedin"
                   [href]="researcher.linkedin"
                   target="_blank"
                   class="social-link hover:bg-blue-600"
                   title="LinkedIn">
                  <i class="fab fa-linkedin-in"></i>
                </a>
              </div>
            </div>
          </article>
        </div>
      </section>

    </div>
  </div>

</div>
